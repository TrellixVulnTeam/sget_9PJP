/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { ReplaySubject } from 'rxjs';
import { BlockUIActions } from '../constants/block-ui-actions.constant';
import { BlockUIDefaultName } from '../constants/block-ui-default-name.constant';
import * as ɵngcc0 from '@angular/core';
var BlockUIInstanceService = /** @class */ (function () {
    function BlockUIInstanceService() {
        this.blockUISettings = {};
        this.blockUIInstances = {};
        this.blockUISubject = new ReplaySubject();
        this.blockUIObservable = this.blockUISubject.asObservable();
        this.blockUIObservable.subscribe(this.blockUIMiddleware.bind(this));
    }
    /**
     * @return {?}
     */
    BlockUIInstanceService.prototype.getSettings = /**
     * @return {?}
     */
    function () {
        return this.blockUISettings;
    };
    /**
     * @param {?=} settings
     * @return {?}
     */
    BlockUIInstanceService.prototype.updateSettings = /**
     * @param {?=} settings
     * @return {?}
     */
    function (settings) {
        if (settings === void 0) { settings = {}; }
        this.blockUISettings = tslib_1.__assign({}, this.blockUISettings, settings);
    };
    /**
     * @param {?=} name
     * @return {?}
     */
    BlockUIInstanceService.prototype.decorate = /**
     * @param {?=} name
     * @return {?}
     */
    function (name) {
        if (name === void 0) { name = BlockUIDefaultName; }
        var /** @type {?} */ blockUI = /** @type {?} */ ({
            name: name,
            isActive: false,
            blockCount: 0,
            start: this.dispatch(this.blockUISubject, BlockUIActions.START, name),
            update: this.dispatch(this.blockUISubject, BlockUIActions.UPDATE, name),
            stop: this.dispatch(this.blockUISubject, BlockUIActions.STOP, name),
            reset: this.dispatch(this.blockUISubject, BlockUIActions.RESET, name),
            unsubscribe: this.dispatch(this.blockUISubject, BlockUIActions.UNSUBSCRIBE, name)
        });
        this.blockUIInstances[name] = this.blockUIInstances[name] || blockUI;
        return blockUI;
    };
    /**
     * @return {?}
     */
    BlockUIInstanceService.prototype.observe = /**
     * @return {?}
     */
    function () {
        return this.blockUIObservable;
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    BlockUIInstanceService.prototype.blockUIMiddleware = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var action = _a.action, name = _a.name;
        var /** @type {?} */ isActive = null;
        switch (action) {
            case (BlockUIActions.START):
                isActive = true;
                break;
            case (BlockUIActions.STOP):
            case (BlockUIActions.RESET):
                isActive = false;
                break;
        }
        if (isActive !== null) {
            this.blockUIInstances[name].isActive = isActive;
        }
    };
    /**
     * @param {?} subject
     * @param {?} action
     * @param {?=} name
     * @return {?}
     */
    BlockUIInstanceService.prototype.dispatch = /**
     * @param {?} subject
     * @param {?} action
     * @param {?=} name
     * @return {?}
     */
    function (subject, action, name) {
        if (name === void 0) { name = BlockUIDefaultName; }
        return function (message) {
            subject.next({
                name: name,
                action: action,
                message: message
            });
        };
    };
    /** @nocollapse */
    BlockUIInstanceService.ctorParameters = function () { return []; };
BlockUIInstanceService.ɵfac = function BlockUIInstanceService_Factory(t) { return new (t || BlockUIInstanceService)(); };
BlockUIInstanceService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: BlockUIInstanceService, factory: function (t) { return BlockUIInstanceService.ɵfac(t); } });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(BlockUIInstanceService, [{
        type: Injectable
    }], function () { return []; }, null); })();
    return BlockUIInstanceService;
}());
export { BlockUIInstanceService };
function BlockUIInstanceService_tsickle_Closure_declarations() {
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUISettings;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUIInstances;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUISubject;
    /** @type {?} */
    BlockUIInstanceService.prototype.blockUIObservable;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmxvY2stdWktaW5zdGFuY2Uuc2VydmljZS5qcyIsInNvdXJjZXMiOlsibmctYmxvY2stdWkvc2VydmljZXMvYmxvY2stdWktaW5zdGFuY2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFjLGFBQWEsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNqRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDeEUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNkNBQTZDLENBQUM7O0FBQ2pGO0FBQ0ksSUFXRjtBQUNrQiwrQkFOdUIsRUFBRTtBQUM3QyxnQ0FBMEIsRUFBRTtBQUM1Qiw4QkFBK0MsSUFBSSxhQUFhLEVBQUU7QUFDbEUsaUNBQStDLElBQUksQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFO0FBQ2pGLFFBRUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDeEUsS0FBRztBQUNIO0FBQ087QUFBbUI7QUFBUSxJQUFoQyw0Q0FBVztBQUFPO0FBQW1CO0FBQ2pDLElBREo7QUFBYyxRQUNaLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDO0FBQ2hDLEtBQUc7QUFFSDtBQUFRO0FBQTRCO0FBQW1CO0FBQ3ZELElBREUsK0NBQWM7QUFBTztBQUE0QjtBQUM1QztBQUFRLElBRGIsVUFBZSxRQUFvQztBQUFJLFFBQXhDLHlCQUFBLEVBQUEsYUFBb0M7QUFBSSxRQUNyRCxJQUFJLENBQUMsZUFBZSx3QkFBUSxJQUFJLENBQUMsZUFBZSxFQUFLLFFBQVEsQ0FBRSxDQUFDO0FBQ3BFLEtBQUc7QUFFSDtBQUFRO0FBQXdCO0FBQW1CO0FBQ25ELElBREUseUNBQVE7QUFBTztBQUF3QjtBQUN4QztBQUFRLElBRFAsVUFB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VUssc0JBQXNCO0FBQ2xDO0FBQ2tCO0FBQ1Q7QUFBc0Q7QUFDL0M7QUFBdUQ7QUFFL0Q7QUFDbUM7QUFBcUI7QUFJL0Q7O0FBckJBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFhQSxBQUxBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFsRUEsQUFBQSxBQVRBLEFBVUEsQUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIFJlcGxheVN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEJsb2NrVUlBY3Rpb25zIH0gZnJvbSAnLi4vY29uc3RhbnRzL2Jsb2NrLXVpLWFjdGlvbnMuY29uc3RhbnQnO1xuaW1wb3J0IHsgQmxvY2tVSURlZmF1bHROYW1lIH0gZnJvbSAnLi4vY29uc3RhbnRzL2Jsb2NrLXVpLWRlZmF1bHQtbmFtZS5jb25zdGFudCc7XG5pbXBvcnQgeyBOZ0Jsb2NrVUkgfSBmcm9tICcuLi9tb2RlbHMvYmxvY2stdWkubW9kZWwnO1xuaW1wb3J0IHsgQmxvY2tVSVNldHRpbmdzIH0gZnJvbSAnLi4vbW9kZWxzL2Jsb2NrLXVpLXNldHRpbmdzLm1vZGVsJztcbmltcG9ydCB7IEJsb2NrVUlFdmVudCB9IGZyb20gJy4uL21vZGVscy9ibG9jay11aS1ldmVudC5tb2RlbCc7XG5cblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEJsb2NrVUlJbnN0YW5jZVNlcnZpY2Uge1xuICBibG9ja1VJU2V0dGluZ3M6IEJsb2NrVUlTZXR0aW5ncyB8IGFueSA9IHt9O1xuICBibG9ja1VJSW5zdGFuY2VzOiBhbnkgPSB7fTtcbiAgcHJpdmF0ZSBibG9ja1VJU3ViamVjdDogUmVwbGF5U3ViamVjdDxhbnk+ID0gbmV3IFJlcGxheVN1YmplY3QoKTtcbiAgcHJpdmF0ZSBibG9ja1VJT2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxhbnk+ID0gdGhpcy5ibG9ja1VJU3ViamVjdC5hc09ic2VydmFibGUoKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmJsb2NrVUlPYnNlcnZhYmxlLnN1YnNjcmliZSh0aGlzLmJsb2NrVUlNaWRkbGV3YXJlLmJpbmQodGhpcykpO1xuICB9XG5cbiAgZ2V0U2V0dGluZ3MoKTogQmxvY2tVSVNldHRpbmdzIHwgYW55IHtcbiAgICByZXR1cm4gdGhpcy5ibG9ja1VJU2V0dGluZ3M7XG4gIH1cblxuICB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogQmxvY2tVSVNldHRpbmdzIHwgYW55ID0ge30pOiB2b2lkIHtcbiAgICB0aGlzLmJsb2NrVUlTZXR0aW5ncyA9IHsgLi4udGhpcy5ibG9ja1VJU2V0dGluZ3MsIC4uLnNldHRpbmdzIH07XG4gIH1cblxuICBkZWNvcmF0ZShuYW1lOiBzdHJpbmcgPSBCbG9ja1VJRGVmYXVsdE5hbWUpOiBOZ0Jsb2NrVUkge1xuICAgIGNvbnN0IGJsb2NrVUkgPSB7XG4gICAgICBuYW1lLFxuICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgYmxvY2tDb3VudDogMCxcbiAgICAgIHN0YXJ0OiB0aGlzLmRpc3BhdGNoKHRoaXMuYmxvY2tVSVN1YmplY3QsIEJsb2NrVUlBY3Rpb25zLlNUQVJULCBuYW1lKSxcbiAgICAgIHVwZGF0ZTogdGhpcy5kaXNwYXRjaCh0aGlzLmJsb2NrVUlTdWJqZWN0LCBCbG9ja1VJQWN0aW9ucy5VUERBVEUsIG5hbWUpLFxuICAgICAgc3RvcDogdGhpcy5kaXNwYXRjaCh0aGlzLmJsb2NrVUlTdWJqZWN0LCBCbG9ja1VJQWN0aW9ucy5TVE9QLCBuYW1lKSxcbiAgICAgIHJlc2V0OiB0aGlzLmRpc3BhdGNoKHRoaXMuYmxvY2tVSVN1YmplY3QsIEJsb2NrVUlBY3Rpb25zLlJFU0VULCBuYW1lKSxcbiAgICAgIHVuc3Vic2NyaWJlOiB0aGlzLmRpc3BhdGNoKHRoaXMuYmxvY2tVSVN1YmplY3QsIEJsb2NrVUlBY3Rpb25zLlVOU1VCU0NSSUJFLCBuYW1lKVxuICAgIH0gYXMgTmdCbG9ja1VJO1xuXG4gICAgdGhpcy5ibG9ja1VJSW5zdGFuY2VzW25hbWVdID0gdGhpcy5ibG9ja1VJSW5zdGFuY2VzW25hbWVdIHx8IGJsb2NrVUk7XG5cbiAgICByZXR1cm4gYmxvY2tVSTtcbiAgfVxuXG4gIG9ic2VydmUoKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5ibG9ja1VJT2JzZXJ2YWJsZTtcbiAgfVxuXG4gIHByaXZhdGUgYmxvY2tVSU1pZGRsZXdhcmUoeyBhY3Rpb24sIG5hbWUgfTogQmxvY2tVSUV2ZW50KTogdm9pZCB7XG4gICAgbGV0IGlzQWN0aXZlOiBib29sZWFuID0gbnVsbDtcblxuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlIChCbG9ja1VJQWN0aW9ucy5TVEFSVCk6XG4gICAgICAgIGlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgKEJsb2NrVUlBY3Rpb25zLlNUT1ApOlxuICAgICAgY2FzZSAoQmxvY2tVSUFjdGlvbnMuUkVTRVQpOlxuICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAoaXNBY3RpdmUgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuYmxvY2tVSUluc3RhbmNlc1tuYW1lXS5pc0FjdGl2ZSA9IGlzQWN0aXZlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGlzcGF0Y2goc3ViamVjdDogUmVwbGF5U3ViamVjdDxhbnk+LCBhY3Rpb246IEJsb2NrVUlBY3Rpb25zLCBuYW1lOiBzdHJpbmcgPSBCbG9ja1VJRGVmYXVsdE5hbWUpOiBGdW5jdGlvbiB7XG4gICAgcmV0dXJuIChtZXNzYWdlPzogYW55KTogdm9pZCA9PiB7XG4gICAgICBzdWJqZWN0Lm5leHQoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhY3Rpb24sXG4gICAgICAgIG1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cbn1cbiJdfQ==